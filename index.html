<!DOCTYPE html><html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Gestion des présences </title>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <style>
    body { font-family: Arial; padding: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #f0f0f0; }
    .ok { background-color: #c8e6c9; }
    .nt { background-color: #ffe082; }
    .ko { background-color: #ef9a9a; }
  </style>
</head>
<body><h2>Suivi des utilisateurs et des applications</h2><form id="presenceForm">
  <label>Utilisateur : <input type="text" id="utilisateur" required></label>
  <label>Application : <input type="text" id="application" required></label>
  <label>Statut :
    <select id="statut">
      <option value="OK">OK</option>
      <option value="NT">NT</option>
      <option value="KO">KO</option>
    </select>
  </label>
  <button type="submit">Ajouter</button>
</form><table id="presenceTable">
  <thead>
    <tr>
      <th>Utilisateur</th>
      <th>Application</th>
      <th>Statut</th>
    </tr>
  </thead>
  <tbody id="tableBody"></tbody>
</table><script>

const firebaseConfig = {
  apiKey: "AIzaSyAeWgUhi1jjUI3STa98kKpkupNaBO8OAhc",
  authDomain: "psi-test-9af56.firebaseapp.com",
  projectId: "psi-test-9af56",
  storageBucket: "psi-test-9af56.firebasestorage.app",
  messagingSenderId: "370916584359",
  appId: "1:370916584359:web:ba5231c9f6642c07dd2482",
  measurementId: "G-QMDJ5517FE"
};

  // Initialiser Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // Charger les données
  function loadData() {
    const tbody = document.getElementById("tableBody");
    tbody.innerHTML = "";

    db.collection("presences").get().then(snapshot => {
      snapshot.forEach(doc => {
        const data = doc.data();
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${data.utilisateur}</td>
          <td>${data.application}</td>
          <td class="${data.statut.toLowerCase()}">${data.statut}</td>
        `;
        tbody.appendChild(row);
      });
    });
  }

  loadData();

  // Ajouter une nouvelle entrée
  document.getElementById("presenceForm").addEventListener("submit", function(e) {
    e.preventDefault();
    const utilisateur = document.getElementById("utilisateur").value;
    const application = document.getElementById("application").value;
    const statut = document.getElementById("statut").value;

    db.collection("presences").add({
      utilisateur,
      application,
      statut
    }).then(() => {
      loadData();
      document.getElementById("presenceForm").reset();
    });
  });
</script></body>
</html>
